# О ch55x

Есть серия недорогих 51 контроллеров от производителя WCH известного своим USB to Serial ch340, и они отличаются отдругих наличием встроенной поддержки USB. ch559 - многоножка, 64к FLASH, умеет быть USB хостом и USB девайсом. Хост/девайс ch554 и девайс ch552 - в корпусе как у 340, 16к FLASH. И младший братишка в таком же корпусе ch551 - 10к FLASH, USB девайс.
Самое прикольное что им не нужен внешний программатор, они программируются прямо по USB (ну или по сериал).

# О реализации

Библиотека подразумевает работу контроллера от встроенного генератора без внешнего кварца с частотой 24MHz. USB используется как `Serial` - CDC. Библиотека использует `Timer0` для delay(), millis() и других функций связанных с временем. Минимальный квант времени 10 мкс. 
Для вывода в `Serial` используется функция `SerialPrintf("строка формата %d 0x%x\n", var1, var2);`. Поддерживаются модификаторы `%d` - десятичное целое, `%x` - шестнадцатеричное, `%o` - восьмиричное, `%c` - символ, `%s` - строка. Для 8 битных чисел при передаче в строку параметров преобразуйте их к 16 битным - `(int)var8bit`. Для 32 битных чисел есть соответствующие модификаторы: `%ld`,`%lx`,`lo`. Строка может выводится просто как `SerialPrint("строка\n");`. Старайтесь не передавать в `SerialPrintf` много параметров, стэк в контроллере невелик, лучше вызовите функцию несколько раз.
Поддерживаются `pinMode(PIN,mode)`, `digitalRead(PIN)`, `digitalWrite(PIN,value)`. Обратите внимание что цифровой пин имеет формат записи: `D{номер порта}{номер пина}`. Какие пины существуют для данного контроллера можно посмотреть в `gpio.h`.
Поддерживается `analogRead(PIN)`, естественно только на тех ногах `A{номер порта}{номер пина}` на которых он доступен. Необходимо использовать `pinMode(Axx,INPUT)`. Диапазон преобразования [0...Vcc] -> `[0..255]`.
